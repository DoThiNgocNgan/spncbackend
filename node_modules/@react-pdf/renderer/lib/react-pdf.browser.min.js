import*as e from"@react-pdf/primitives";export*from"@react-pdf/primitives";import r from"queue";import{useRef as t,useState as o,useEffect as n,useCallback as i}from"react";import l from"@react-pdf/font";import c from"@react-pdf/render";import a from"@react-pdf/pdfkit";import s from"@react-pdf/layout";import d from"@react-pdf/reconciler";import{jsx as p}from"react/jsx-runtime";const u=(e,r)=>{let{style:t,children:o,...n}=r;return{type:e,box:{},style:t||{},props:n||{},children:[]}},m=e=>({type:"TEXT_INSTANCE",value:e}),f=(e,r)=>{const t="TEXT"===e.type||"LINK"===e.type||"TSPAN"===e.type;"TEXT_INSTANCE"!==r.type||t?e.children.push(r):console.warn(`Invalid '${r.value}' string child outside <Text> component`)},v=(e,r)=>{"ROOT"===e.type?e.document=r:f(e,r)},h=(e,r,t)=>{var o;const n=null===(o=e.children)||void 0===o?void 0:o.indexOf(t);void 0!==n&&-1!==n&&r&&e.children.splice(n,0,r)},b=(e,r)=>{var t;const o=null===(t=e.children)||void 0===t?void 0:t.indexOf(r);void 0!==o&&-1!==o&&e.children.splice(o,1)},g=(e,r)=>{var t;const o=null===(t=e.children)||void 0===t?void 0:t.indexOf(r);void 0!==o&&-1!==o&&e.children.splice(o,1)},y=(e,r,t)=>{e.value=t},w=(e,r,t,o,n)=>{const{style:i,...l}=n;e.props=l,e.style=i},T=e=>{let{onChange:r=(()=>{})}=e;return d({appendChild:f,appendChildToContainer:v,commitTextUpdate:y,commitUpdate:w,createInstance:u,createTextInstance:m,insertBefore:h,removeChild:b,removeChildFromContainer:g,resetAfterCommit:r})};var C={name:"@react-pdf/renderer",version:"4.0.2",license:"MIT",description:"Create PDF files on the browser and server",author:"Diego Muracciole <diegomuracciole@gmail.com>",homepage:"https://github.com/diegomura/react-pdf#readme",type:"module",main:"./lib/react-pdf.js",browser:{"./lib/react-pdf.js":"./lib/react-pdf.browser.js"},repository:{type:"git",url:"https://github.com/diegomura/react-pdf.git",directory:"packages/renderer"},scripts:{build:"rimraf ./lib && rollup -c",watch:"rimraf ./lib && rollup -c -w",size:"size-limit",lint:"eslint src",test:"vitest && vitest --config vitest.browser.config.js"},dependencies:{"@babel/runtime":"^7.20.13","@react-pdf/font":"^3.0.0","@react-pdf/layout":"^4.1.0","@react-pdf/pdfkit":"^4.0.0","@react-pdf/primitives":"^4.0.0","@react-pdf/reconciler":"^1.0.1","@react-pdf/render":"^4.0.0","@react-pdf/types":"^2.7.0",events:"^3.3.0","object-assign":"^4.1.1","prop-types":"^15.6.2",queue:"^6.0.1",scheduler:"^0.17.0"},peerDependencies:{react:"^16.8.0 || ^17.0.0 || ^18.0.0"},"lint-staged":{"*.js":["yarn lint","prettier --write"]},files:["lib","index.d.ts"],collective:{type:"opencollective",url:"https://opencollective.com/react-pdf",logo:"https://opencollective.com/opencollective/logo.txt"},devDependencies:{"@size-limit/preset-big-lib":"^11.0.1",assert:"^2.0.0","browserify-zlib":"^0.2.0",buffer:"^6.0.3",process:"^0.11.10","size-limit":"^11.0.1",util:"^0.12.4"}};const{version:S}=C,N=new l;let A;const L={},_=e=>{const r={type:"ROOT",document:null};A=A||T({onChange:()=>{var e;const r=(null===(e=L.change)||void 0===e?void 0:e.slice())||[];for(let e=0;e<r.length;e+=1)r[e]()}});const t=A.createContainer(r),o=(e,r)=>{A.updateContainer(e,t,null,r)};e&&o(e);const n=async function(e){void 0===e&&(e=!0);const t=r.document.props||{},{pdfVersion:o,language:n,pageLayout:i,pageMode:l}=t,d=new a({compress:e,pdfVersion:o,lang:n,displayTitle:!0,autoFirstPage:!1,pageLayout:i,pageMode:l}),p=await s(r.document,N);return{layout:p,fileStream:c(d,p)}},i=function(e){void 0===e&&(e={}),r.document.props.onRender&&r.document.props.onRender(e)};return{on:(e,r)=>{L[e]||(L[e]=[]),L[e].push(r)},container:r,toBlob:async()=>{const e=[],{layout:r,fileStream:t}=await n();return new Promise(((o,n)=>{t.on("data",(r=>{e.push(r instanceof Uint8Array?r:new Uint8Array(r))})),t.on("end",(()=>{try{const t=new Blob(e,{type:"application/pdf"});i({blob:t,_INTERNAL__LAYOUT__DATA_:r}),o(t)}catch(e){n(e)}}))}))},toBuffer:async()=>{const{layout:e,fileStream:r}=await n();return i({_INTERNAL__LAYOUT__DATA_:e}),r},toString:async()=>{"development"===process.env.NODE_ENV&&console.warn("`toString` is deprecated and will be removed in next major release");let e="";const{fileStream:r}=await n(!1);return new Promise(((t,o)=>{try{r.on("data",(r=>{e+=r})),r.on("end",(()=>{i(),t(e)}))}catch(e){o(e)}}))},removeListener:(e,r)=>{if(!L[e])return;const t=L[e].indexOf(r);t>-1&&L[e].splice(t,1)},updateContainer:o}},x=N,D={create:e=>e},O=function(e){let{document:l}=void 0===e?{}:e;const c=t(null),[a,s]=o({url:null,blob:null,error:null,loading:!!l});n((()=>{const e=r({autostart:!0,concurrency:1}),t=()=>{s((e=>({...e,loading:!0}))),e.splice(0,e.length,(()=>a.error?Promise.resolve():c.current.toBlob()))};return c.current=_(),c.current.on("change",t),l&&c.current.updateContainer(l),e.on("error",(e=>{console.error(e),s((r=>({...r,loading:!1,error:e})))})),e.on("success",(e=>{s({blob:e,error:null,loading:!1,url:URL.createObjectURL(e)})})),()=>{e.end(),c.current.removeListener("change",t)}}),[]),n((()=>()=>{a.url&&URL.revokeObjectURL(a.url)}),[a.url]);const d=i((e=>{c.current.updateContainer(e)}),[]);return[a,d]},P=e=>{let{title:r,style:t,className:o,children:i,innerRef:l,showToolbar:c=!0,...a}=e;const[s,d]=O();n((()=>d(i)),[i]);const u=s.url?`${s.url}#toolbar=${c?1:0}`:null;return p("iframe",{src:u,title:r,ref:l,style:t,className:o,...a})},R=e=>{let{document:r,children:t}=e;const[o,i]=O();return n((()=>i(r)),[r]),r?t(o):(console.warn("You should pass a valid document to BlobProvider"),null)},j=e=>{let{fileName:r="document.pdf",document:t,children:o,onClick:i,href:l,...c}=e;const[a,s]=O();if(n((()=>s(t)),[t]),!t)return console.warn("You should pass a valid document to PDFDownloadLink"),null;return p("a",{href:a.url,download:r,onClick:e=>{a&&window.navigator.msSaveBlob&&window.navigator.msSaveBlob(a.blob,r),"function"==typeof i&&i(e,a)},...c,children:"function"==typeof o?o(a):o})},B=e=>{throw new Error(`${e} is a Node specific API. You're either using this method in a browser, or your bundler is not loading react-pdf from the appropriate web build.`)},E=()=>{B("renderToStream")},F=()=>{B("renderToBuffer")},I=()=>{B("renderToString")},U=()=>{B("renderToFile")},k=()=>{B("render")};var z={pdf:_,usePDF:O,Font:x,version:S,StyleSheet:D,PDFViewer:P,BlobProvider:R,PDFDownloadLink:j,renderToStream:E,renderToString:I,renderToFile:U,render:k,...e};export{R as BlobProvider,x as Font,j as PDFDownloadLink,P as PDFViewer,D as StyleSheet,T as createRenderer,z as default,_ as pdf,k as render,F as renderToBuffer,U as renderToFile,E as renderToStream,I as renderToString,O as usePDF,S as version};
